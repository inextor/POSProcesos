<div class="container-fluid">
  <h1>Reporte de Ventas Detalladas (COMEX)</h1>
  <hr>

  <form (ngSubmit)="generateReport()" class="mb-4" ngNativeValidate>
    <div class="row g-3 align-items-end">
      <div class="col-md-3">
        <label for="fecha_inicio" class="form-label">Fecha Inicio</label>
        <input type="datetime-local" id="fecha_inicio" name="fecha_inicio" class="form-control" [(ngModel)]="start_date" required>
      </div>
      <div class="col-md-3">
        <label for="fecha_fin" class="form-label">Fecha Fin</label>
        <input type="datetime-local" id="fecha_fin" name="fecha_fin" class="form-control" [(ngModel)]="end_date" required>
      </div>
      <div class="col-md-4">
        <label for="id_store" class="form-label">Sucursal</label>
        <select id="id_store" name="id_store" class="form-select" [(ngModel)]="store_id" required>
          <option value="">Seleccione una sucursal</option>
			@for(store of store_list; track store.id)
			{
				<option [value]="store.id">{{ store.name }}</option>
			}
        </select>
      </div>
      <div class="col-md-2">
        <button type="submit" class="btn btn-primary w-100" [disabled]="is_loading">
          @if (is_loading) {
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          }
          {{ is_loading ? 'Generando...' : 'Generar Reporte' }}
        </button>
      </div>
    </div>
  </form>

    @if (is_loading) {
    <div class="progress">
      <div class="progress-bar" role="progressbar" [style.width.%]="progress" [attr.aria-valuenow]="progress" aria-valuemin="0" aria-valuemax="100">
        {{ progress.toFixed(0) }}%
      </div>
    </div>
    <div class="text-center mt-2">
      <p>{{ progress_message }}</p>
    </div>
  }

</div>
